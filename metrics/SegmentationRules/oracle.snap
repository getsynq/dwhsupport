
[TestMetricsSuite/TestSegmentationRules/oracle_allowed_segments - 1]
select
  COALESCE(SUBSTR(TO_CHAR(workspace), 1, 100), '') as "segment", 
  COUNT("ingested_at") as "num_not_null", 
  min("ingested_at") as "min", 
  max("ingested_at") as "max"
from "default"."runs" 
where COALESCE(SUBSTR(TO_CHAR(workspace), 1, 100), '') in ('synq-demo', 'synq-demo-2')
group by COALESCE(SUBSTR(TO_CHAR(workspace), 1, 100), '')
order by COALESCE(SUBSTR(TO_CHAR(workspace), 1, 100), '') 
---

[TestMetricsSuite/TestSegmentationRules/oracle_empty_exclude - 1]
select
  COALESCE(SUBSTR(TO_CHAR(workspace), 1, 100), '') as "segment", 
  COUNT("ingested_at") as "num_not_null", 
  min("ingested_at") as "min", 
  max("ingested_at") as "max"
from "default"."runs" 
group by COALESCE(SUBSTR(TO_CHAR(workspace), 1, 100), '')
order by COALESCE(SUBSTR(TO_CHAR(workspace), 1, 100), '') 
---

[TestMetricsSuite/TestSegmentationRules/oracle_empty_include - 1]
select
  COALESCE(SUBSTR(TO_CHAR(workspace), 1, 100), '') as "segment", 
  COUNT("ingested_at") as "num_not_null", 
  min("ingested_at") as "min", 
  max("ingested_at") as "max"
from "default"."runs" 
where (1=2)
group by COALESCE(SUBSTR(TO_CHAR(workspace), 1, 100), '')
order by COALESCE(SUBSTR(TO_CHAR(workspace), 1, 100), '') 
---
