
[TestMetricsSuite/TestSegmentWithTimeRange - 1]
select
  coalesce(toString(workspace), '') as segment, 
  'run_type' as field, 
  toInt64(count(*)) as num_rows, 
  coalesce(toInt64(count(run_type)), 0) as num_not_null, 
  coalesce(toInt64(count(distinct run_type)), 0) as num_unique, 
  coalesce(toInt64(countIf(run_type = 0)), 0) as num_empty, 
  toFloat64(coalesce(avg(run_type), 0)) as mean, 
  toFloat64(coalesce(min(run_type), 0)) as min, 
  toFloat64(coalesce(max(run_type), 0)) as max, 
  toFloat64(coalesce(median(run_type), 0)) as median, 
  toFloat64(coalesce(stddevSamp(run_type), 0)) as stddev
from default.runs 
where
  ingested_at >= parseDateTimeBestEffort('2025-01-01 00:00:00') and 
  ingested_at < parseDateTimeBestEffort('2025-02-01 00:00:00')
group by segment
order by segment 
---
