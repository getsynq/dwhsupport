
[TestMetricsSuite/TestMultiMetricValues - 1]
select
  COALESCE(workspace, '') as segment, 
  COALESCE(run_type, '') as segment_2, 
  count(workspace) as workspace$num_not_null, 
  count(distinct workspace) as workspace$num_unique, 
  COALESCE(countif(workspace = ''), 0) as workspace$num_empty, 
  count(run_type) as run_type$num_not_null, 
  count(distinct run_type) as run_type$num_unique, 
  COALESCE(countif(run_type = 0), 0) as run_type$num_empty, 
  CAST(COALESCE(avg(run_type), 0) AS FLOAT64) as run_type$mean, 
  CAST(COALESCE(min(run_type), 0) AS FLOAT64) as run_type$min, 
  CAST(COALESCE(max(run_type), 0) AS FLOAT64) as run_type$max, 
  CAST(COALESCE(approx_quantiles(run_type, 2)[offset(1)], 0) AS FLOAT64) as run_type$median, 
  CAST(COALESCE(stddev_samp(run_type), 0) AS FLOAT64) as run_type$stddev
from `db.default.runs` 

group by
  COALESCE(workspace, ''), 
  COALESCE(run_type, '')
order by
  COALESCE(workspace, ''), 
  COALESCE(run_type, '') 
---
