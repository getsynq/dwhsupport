
[TestProfileSuite/TestProfileColumns/oracle_multi_condition_multi_segmentation - 1]
select
  SUBSTR(TO_CHAR(workspace), 1, 100) as "segment", 
  SUBSTR(TO_CHAR(run_status), 1, 100) as "segment2", 
  SUBSTR(TO_CHAR(run_type), 1, 100) as "segment3", 
  COUNT(*) as "num_rows", 
  COUNT(workspace) as "workspace$num_not_null", 
  COUNT(distinct workspace) as "workspace$num_unique", 
  SUM(CASE WHEN workspace = '' THEN 1 ELSE 0 END) as "workspace$num_empty", 
  CAST(min(length(workspace)) AS BINARY_DOUBLE) as "workspace$min_length", 
  CAST(max(length(workspace)) AS BINARY_DOUBLE) as "workspace$max_length", 
  CAST(avg(length(workspace)) AS BINARY_DOUBLE) as "workspace$mean_length", 
  COUNT(meta) as "meta$num_not_null", 
  COUNT(distinct meta) as "meta$num_unique", 
  SUM(CASE WHEN meta = '' THEN 1 ELSE 0 END) as "meta$num_empty", 
  CAST(min(length(meta)) AS BINARY_DOUBLE) as "meta$min_length", 
  CAST(max(length(meta)) AS BINARY_DOUBLE) as "meta$max_length", 
  CAST(avg(length(meta)) AS BINARY_DOUBLE) as "meta$mean_length", 
  COUNT(run_status) as "run_status$num_not_null", 
  COUNT(distinct run_status) as "run_status$num_unique", 
  SUM(CASE WHEN run_status = 0 THEN 1 ELSE 0 END) as "run_status$num_empty", 
  CAST(avg(run_status) AS BINARY_DOUBLE) as "run_status$mean", 
  CAST(min(run_status) AS BINARY_DOUBLE) as "run_status$min", 
  CAST(max(run_status) AS BINARY_DOUBLE) as "run_status$max", 
  CAST(MEDIAN(run_status) AS BINARY_DOUBLE) as "run_status$median", 
  CAST(STDDEV(run_status) AS BINARY_DOUBLE) as "run_status$stddev", 
  COUNT("created_at") as "created_at$num_not_null", 
  min("created_at") as "created_at$min", 
  max("created_at") as "created_at$max"
from "default"."runs" 
where (run_status > 0) and (run_type > 0)
group by
  SUBSTR(TO_CHAR(workspace), 1, 100) as "segment", 
  SUBSTR(TO_CHAR(run_status), 1, 100) as "segment2", 
  SUBSTR(TO_CHAR(run_type), 1, 100) as "segment3"
order by "num_rows" desc FETCH FIRST 1000 ROWS ONLY
---

[TestProfileSuite/TestProfileColumns/oracle_multi_condition_no_segmentation - 1]
select
  COUNT(*) as "num_rows", 
  COUNT(workspace) as "workspace$num_not_null", 
  COUNT(distinct workspace) as "workspace$num_unique", 
  SUM(CASE WHEN workspace = '' THEN 1 ELSE 0 END) as "workspace$num_empty", 
  CAST(min(length(workspace)) AS BINARY_DOUBLE) as "workspace$min_length", 
  CAST(max(length(workspace)) AS BINARY_DOUBLE) as "workspace$max_length", 
  CAST(avg(length(workspace)) AS BINARY_DOUBLE) as "workspace$mean_length", 
  COUNT(meta) as "meta$num_not_null", 
  COUNT(distinct meta) as "meta$num_unique", 
  SUM(CASE WHEN meta = '' THEN 1 ELSE 0 END) as "meta$num_empty", 
  CAST(min(length(meta)) AS BINARY_DOUBLE) as "meta$min_length", 
  CAST(max(length(meta)) AS BINARY_DOUBLE) as "meta$max_length", 
  CAST(avg(length(meta)) AS BINARY_DOUBLE) as "meta$mean_length", 
  COUNT(run_status) as "run_status$num_not_null", 
  COUNT(distinct run_status) as "run_status$num_unique", 
  SUM(CASE WHEN run_status = 0 THEN 1 ELSE 0 END) as "run_status$num_empty", 
  CAST(avg(run_status) AS BINARY_DOUBLE) as "run_status$mean", 
  CAST(min(run_status) AS BINARY_DOUBLE) as "run_status$min", 
  CAST(max(run_status) AS BINARY_DOUBLE) as "run_status$max", 
  CAST(MEDIAN(run_status) AS BINARY_DOUBLE) as "run_status$median", 
  CAST(STDDEV(run_status) AS BINARY_DOUBLE) as "run_status$stddev", 
  COUNT("created_at") as "created_at$num_not_null", 
  min("created_at") as "created_at$min", 
  max("created_at") as "created_at$max"
from "default"."runs" 
where (run_status > 0) and (run_type > 0)
order by "num_rows" desc FETCH FIRST 1000 ROWS ONLY
---

[TestProfileSuite/TestProfileColumns/oracle_multi_condition_single_segmentation_all - 1]
select
  SUBSTR(TO_CHAR(run_type), 1, 100) as "segment", 
  COUNT(*) as "num_rows", 
  COUNT(workspace) as "workspace$num_not_null", 
  COUNT(distinct workspace) as "workspace$num_unique", 
  SUM(CASE WHEN workspace = '' THEN 1 ELSE 0 END) as "workspace$num_empty", 
  CAST(min(length(workspace)) AS BINARY_DOUBLE) as "workspace$min_length", 
  CAST(max(length(workspace)) AS BINARY_DOUBLE) as "workspace$max_length", 
  CAST(avg(length(workspace)) AS BINARY_DOUBLE) as "workspace$mean_length", 
  COUNT(meta) as "meta$num_not_null", 
  COUNT(distinct meta) as "meta$num_unique", 
  SUM(CASE WHEN meta = '' THEN 1 ELSE 0 END) as "meta$num_empty", 
  CAST(min(length(meta)) AS BINARY_DOUBLE) as "meta$min_length", 
  CAST(max(length(meta)) AS BINARY_DOUBLE) as "meta$max_length", 
  CAST(avg(length(meta)) AS BINARY_DOUBLE) as "meta$mean_length", 
  COUNT(run_status) as "run_status$num_not_null", 
  COUNT(distinct run_status) as "run_status$num_unique", 
  SUM(CASE WHEN run_status = 0 THEN 1 ELSE 0 END) as "run_status$num_empty", 
  CAST(avg(run_status) AS BINARY_DOUBLE) as "run_status$mean", 
  CAST(min(run_status) AS BINARY_DOUBLE) as "run_status$min", 
  CAST(max(run_status) AS BINARY_DOUBLE) as "run_status$max", 
  CAST(MEDIAN(run_status) AS BINARY_DOUBLE) as "run_status$median", 
  CAST(STDDEV(run_status) AS BINARY_DOUBLE) as "run_status$stddev", 
  COUNT("created_at") as "created_at$num_not_null", 
  min("created_at") as "created_at$min", 
  max("created_at") as "created_at$max"
from "default"."runs" 
where (run_status > 0) and (run_type > 0)
group by SUBSTR(TO_CHAR(run_type), 1, 100) as "segment"
order by "num_rows" desc FETCH FIRST 1000 ROWS ONLY
---

[TestProfileSuite/TestProfileColumns/oracle_no_conditions_multi_segmentation - 1]
select
  SUBSTR(TO_CHAR(workspace), 1, 100) as "segment", 
  SUBSTR(TO_CHAR(run_status), 1, 100) as "segment2", 
  SUBSTR(TO_CHAR(run_type), 1, 100) as "segment3", 
  COUNT(*) as "num_rows", 
  COUNT(workspace) as "workspace$num_not_null", 
  COUNT(distinct workspace) as "workspace$num_unique", 
  SUM(CASE WHEN workspace = '' THEN 1 ELSE 0 END) as "workspace$num_empty", 
  CAST(min(length(workspace)) AS BINARY_DOUBLE) as "workspace$min_length", 
  CAST(max(length(workspace)) AS BINARY_DOUBLE) as "workspace$max_length", 
  CAST(avg(length(workspace)) AS BINARY_DOUBLE) as "workspace$mean_length", 
  COUNT(meta) as "meta$num_not_null", 
  COUNT(distinct meta) as "meta$num_unique", 
  SUM(CASE WHEN meta = '' THEN 1 ELSE 0 END) as "meta$num_empty", 
  CAST(min(length(meta)) AS BINARY_DOUBLE) as "meta$min_length", 
  CAST(max(length(meta)) AS BINARY_DOUBLE) as "meta$max_length", 
  CAST(avg(length(meta)) AS BINARY_DOUBLE) as "meta$mean_length", 
  COUNT(run_status) as "run_status$num_not_null", 
  COUNT(distinct run_status) as "run_status$num_unique", 
  SUM(CASE WHEN run_status = 0 THEN 1 ELSE 0 END) as "run_status$num_empty", 
  CAST(avg(run_status) AS BINARY_DOUBLE) as "run_status$mean", 
  CAST(min(run_status) AS BINARY_DOUBLE) as "run_status$min", 
  CAST(max(run_status) AS BINARY_DOUBLE) as "run_status$max", 
  CAST(MEDIAN(run_status) AS BINARY_DOUBLE) as "run_status$median", 
  CAST(STDDEV(run_status) AS BINARY_DOUBLE) as "run_status$stddev", 
  COUNT("created_at") as "created_at$num_not_null", 
  min("created_at") as "created_at$min", 
  max("created_at") as "created_at$max"
from "default"."runs" 
group by
  SUBSTR(TO_CHAR(workspace), 1, 100) as "segment", 
  SUBSTR(TO_CHAR(run_status), 1, 100) as "segment2", 
  SUBSTR(TO_CHAR(run_type), 1, 100) as "segment3"
order by "num_rows" desc FETCH FIRST 1000 ROWS ONLY
---

[TestProfileSuite/TestProfileColumns/oracle_no_conditions_no_segmentation - 1]
select
  COUNT(*) as "num_rows", 
  COUNT(workspace) as "workspace$num_not_null", 
  COUNT(distinct workspace) as "workspace$num_unique", 
  SUM(CASE WHEN workspace = '' THEN 1 ELSE 0 END) as "workspace$num_empty", 
  CAST(min(length(workspace)) AS BINARY_DOUBLE) as "workspace$min_length", 
  CAST(max(length(workspace)) AS BINARY_DOUBLE) as "workspace$max_length", 
  CAST(avg(length(workspace)) AS BINARY_DOUBLE) as "workspace$mean_length", 
  COUNT(meta) as "meta$num_not_null", 
  COUNT(distinct meta) as "meta$num_unique", 
  SUM(CASE WHEN meta = '' THEN 1 ELSE 0 END) as "meta$num_empty", 
  CAST(min(length(meta)) AS BINARY_DOUBLE) as "meta$min_length", 
  CAST(max(length(meta)) AS BINARY_DOUBLE) as "meta$max_length", 
  CAST(avg(length(meta)) AS BINARY_DOUBLE) as "meta$mean_length", 
  COUNT(run_status) as "run_status$num_not_null", 
  COUNT(distinct run_status) as "run_status$num_unique", 
  SUM(CASE WHEN run_status = 0 THEN 1 ELSE 0 END) as "run_status$num_empty", 
  CAST(avg(run_status) AS BINARY_DOUBLE) as "run_status$mean", 
  CAST(min(run_status) AS BINARY_DOUBLE) as "run_status$min", 
  CAST(max(run_status) AS BINARY_DOUBLE) as "run_status$max", 
  CAST(MEDIAN(run_status) AS BINARY_DOUBLE) as "run_status$median", 
  CAST(STDDEV(run_status) AS BINARY_DOUBLE) as "run_status$stddev", 
  COUNT("created_at") as "created_at$num_not_null", 
  min("created_at") as "created_at$min", 
  max("created_at") as "created_at$max"
from "default"."runs" 
order by "num_rows" desc FETCH FIRST 1000 ROWS ONLY
---

[TestProfileSuite/TestProfileColumns/oracle_no_conditions_single_segmentation_all - 1]
select
  SUBSTR(TO_CHAR(run_type), 1, 100) as "segment", 
  COUNT(*) as "num_rows", 
  COUNT(workspace) as "workspace$num_not_null", 
  COUNT(distinct workspace) as "workspace$num_unique", 
  SUM(CASE WHEN workspace = '' THEN 1 ELSE 0 END) as "workspace$num_empty", 
  CAST(min(length(workspace)) AS BINARY_DOUBLE) as "workspace$min_length", 
  CAST(max(length(workspace)) AS BINARY_DOUBLE) as "workspace$max_length", 
  CAST(avg(length(workspace)) AS BINARY_DOUBLE) as "workspace$mean_length", 
  COUNT(meta) as "meta$num_not_null", 
  COUNT(distinct meta) as "meta$num_unique", 
  SUM(CASE WHEN meta = '' THEN 1 ELSE 0 END) as "meta$num_empty", 
  CAST(min(length(meta)) AS BINARY_DOUBLE) as "meta$min_length", 
  CAST(max(length(meta)) AS BINARY_DOUBLE) as "meta$max_length", 
  CAST(avg(length(meta)) AS BINARY_DOUBLE) as "meta$mean_length", 
  COUNT(run_status) as "run_status$num_not_null", 
  COUNT(distinct run_status) as "run_status$num_unique", 
  SUM(CASE WHEN run_status = 0 THEN 1 ELSE 0 END) as "run_status$num_empty", 
  CAST(avg(run_status) AS BINARY_DOUBLE) as "run_status$mean", 
  CAST(min(run_status) AS BINARY_DOUBLE) as "run_status$min", 
  CAST(max(run_status) AS BINARY_DOUBLE) as "run_status$max", 
  CAST(MEDIAN(run_status) AS BINARY_DOUBLE) as "run_status$median", 
  CAST(STDDEV(run_status) AS BINARY_DOUBLE) as "run_status$stddev", 
  COUNT("created_at") as "created_at$num_not_null", 
  min("created_at") as "created_at$min", 
  max("created_at") as "created_at$max"
from "default"."runs" 
group by SUBSTR(TO_CHAR(run_type), 1, 100) as "segment"
order by "num_rows" desc FETCH FIRST 1000 ROWS ONLY
---

[TestProfileSuite/TestProfileColumns/oracle_single_condition_multi_segmentation - 1]
select
  SUBSTR(TO_CHAR(workspace), 1, 100) as "segment", 
  SUBSTR(TO_CHAR(run_status), 1, 100) as "segment2", 
  SUBSTR(TO_CHAR(run_type), 1, 100) as "segment3", 
  COUNT(*) as "num_rows", 
  COUNT(workspace) as "workspace$num_not_null", 
  COUNT(distinct workspace) as "workspace$num_unique", 
  SUM(CASE WHEN workspace = '' THEN 1 ELSE 0 END) as "workspace$num_empty", 
  CAST(min(length(workspace)) AS BINARY_DOUBLE) as "workspace$min_length", 
  CAST(max(length(workspace)) AS BINARY_DOUBLE) as "workspace$max_length", 
  CAST(avg(length(workspace)) AS BINARY_DOUBLE) as "workspace$mean_length", 
  COUNT(meta) as "meta$num_not_null", 
  COUNT(distinct meta) as "meta$num_unique", 
  SUM(CASE WHEN meta = '' THEN 1 ELSE 0 END) as "meta$num_empty", 
  CAST(min(length(meta)) AS BINARY_DOUBLE) as "meta$min_length", 
  CAST(max(length(meta)) AS BINARY_DOUBLE) as "meta$max_length", 
  CAST(avg(length(meta)) AS BINARY_DOUBLE) as "meta$mean_length", 
  COUNT(run_status) as "run_status$num_not_null", 
  COUNT(distinct run_status) as "run_status$num_unique", 
  SUM(CASE WHEN run_status = 0 THEN 1 ELSE 0 END) as "run_status$num_empty", 
  CAST(avg(run_status) AS BINARY_DOUBLE) as "run_status$mean", 
  CAST(min(run_status) AS BINARY_DOUBLE) as "run_status$min", 
  CAST(max(run_status) AS BINARY_DOUBLE) as "run_status$max", 
  CAST(MEDIAN(run_status) AS BINARY_DOUBLE) as "run_status$median", 
  CAST(STDDEV(run_status) AS BINARY_DOUBLE) as "run_status$stddev", 
  COUNT("created_at") as "created_at$num_not_null", 
  min("created_at") as "created_at$min", 
  max("created_at") as "created_at$max"
from "default"."runs" 
where (1=1)
group by
  SUBSTR(TO_CHAR(workspace), 1, 100) as "segment", 
  SUBSTR(TO_CHAR(run_status), 1, 100) as "segment2", 
  SUBSTR(TO_CHAR(run_type), 1, 100) as "segment3"
order by "num_rows" desc FETCH FIRST 1000 ROWS ONLY
---

[TestProfileSuite/TestProfileColumns/oracle_single_condition_no_segmentation - 1]
select
  COUNT(*) as "num_rows", 
  COUNT(workspace) as "workspace$num_not_null", 
  COUNT(distinct workspace) as "workspace$num_unique", 
  SUM(CASE WHEN workspace = '' THEN 1 ELSE 0 END) as "workspace$num_empty", 
  CAST(min(length(workspace)) AS BINARY_DOUBLE) as "workspace$min_length", 
  CAST(max(length(workspace)) AS BINARY_DOUBLE) as "workspace$max_length", 
  CAST(avg(length(workspace)) AS BINARY_DOUBLE) as "workspace$mean_length", 
  COUNT(meta) as "meta$num_not_null", 
  COUNT(distinct meta) as "meta$num_unique", 
  SUM(CASE WHEN meta = '' THEN 1 ELSE 0 END) as "meta$num_empty", 
  CAST(min(length(meta)) AS BINARY_DOUBLE) as "meta$min_length", 
  CAST(max(length(meta)) AS BINARY_DOUBLE) as "meta$max_length", 
  CAST(avg(length(meta)) AS BINARY_DOUBLE) as "meta$mean_length", 
  COUNT(run_status) as "run_status$num_not_null", 
  COUNT(distinct run_status) as "run_status$num_unique", 
  SUM(CASE WHEN run_status = 0 THEN 1 ELSE 0 END) as "run_status$num_empty", 
  CAST(avg(run_status) AS BINARY_DOUBLE) as "run_status$mean", 
  CAST(min(run_status) AS BINARY_DOUBLE) as "run_status$min", 
  CAST(max(run_status) AS BINARY_DOUBLE) as "run_status$max", 
  CAST(MEDIAN(run_status) AS BINARY_DOUBLE) as "run_status$median", 
  CAST(STDDEV(run_status) AS BINARY_DOUBLE) as "run_status$stddev", 
  COUNT("created_at") as "created_at$num_not_null", 
  min("created_at") as "created_at$min", 
  max("created_at") as "created_at$max"
from "default"."runs" 
where (1=1)
order by "num_rows" desc FETCH FIRST 1000 ROWS ONLY
---

[TestProfileSuite/TestProfileColumns/oracle_single_condition_single_segmentation_all - 1]
select
  SUBSTR(TO_CHAR(run_type), 1, 100) as "segment", 
  COUNT(*) as "num_rows", 
  COUNT(workspace) as "workspace$num_not_null", 
  COUNT(distinct workspace) as "workspace$num_unique", 
  SUM(CASE WHEN workspace = '' THEN 1 ELSE 0 END) as "workspace$num_empty", 
  CAST(min(length(workspace)) AS BINARY_DOUBLE) as "workspace$min_length", 
  CAST(max(length(workspace)) AS BINARY_DOUBLE) as "workspace$max_length", 
  CAST(avg(length(workspace)) AS BINARY_DOUBLE) as "workspace$mean_length", 
  COUNT(meta) as "meta$num_not_null", 
  COUNT(distinct meta) as "meta$num_unique", 
  SUM(CASE WHEN meta = '' THEN 1 ELSE 0 END) as "meta$num_empty", 
  CAST(min(length(meta)) AS BINARY_DOUBLE) as "meta$min_length", 
  CAST(max(length(meta)) AS BINARY_DOUBLE) as "meta$max_length", 
  CAST(avg(length(meta)) AS BINARY_DOUBLE) as "meta$mean_length", 
  COUNT(run_status) as "run_status$num_not_null", 
  COUNT(distinct run_status) as "run_status$num_unique", 
  SUM(CASE WHEN run_status = 0 THEN 1 ELSE 0 END) as "run_status$num_empty", 
  CAST(avg(run_status) AS BINARY_DOUBLE) as "run_status$mean", 
  CAST(min(run_status) AS BINARY_DOUBLE) as "run_status$min", 
  CAST(max(run_status) AS BINARY_DOUBLE) as "run_status$max", 
  CAST(MEDIAN(run_status) AS BINARY_DOUBLE) as "run_status$median", 
  CAST(STDDEV(run_status) AS BINARY_DOUBLE) as "run_status$stddev", 
  COUNT("created_at") as "created_at$num_not_null", 
  min("created_at") as "created_at$min", 
  max("created_at") as "created_at$max"
from "default"."runs" 
where (1=1)
group by SUBSTR(TO_CHAR(run_type), 1, 100) as "segment"
order by "num_rows" desc FETCH FIRST 1000 ROWS ONLY
---
