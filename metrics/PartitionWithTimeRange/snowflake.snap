
[TestMetricsSuite/TestPartitionWithTimeRange - 1]
select
  TIMESTAMPADD(DAY, 1, time_slice(to_timestamp_ntz(ingested_at), 1, 'DAY')) as "time_segment", 
  'run_type' as "field", 
  count(*) as "num_rows", 
  COALESCE(count(run_type), 0) as "num_not_null", 
  COALESCE(count(distinct run_type), 0) as "num_unique", 
  COALESCE(count_if(run_type = 0), 0) as "num_empty", 
  CAST(COALESCE(avg(run_type), 0) AS FLOAT) as "mean", 
  CAST(COALESCE(min(run_type), 0) AS FLOAT) as "min", 
  CAST(COALESCE(max(run_type), 0) AS FLOAT) as "max", 
  CAST(COALESCE(median(run_type), 0) AS FLOAT) as "median", 
  CAST(COALESCE(stddev(run_type), 0) AS FLOAT) as "stddev"
from db.default.runs 
where
  ingested_at >= '2025-01-01T00:00:00Z' and 
  ingested_at < '2025-02-01T00:00:00Z'
group by "time_segment"
order by "time_segment" 
---
