
[TestMetricsSuite/TestPartitionWithTimeRange - 1]
select
  timestamp_add(toStartOfInterval(ingested_at, interval 1 DAY), interval 1 DAY) as time_segment, 
  'run_type' as field, 
  toInt64(count(*)) as num_rows, 
  toInt64(count(run_type)) as num_not_null, 
  toInt64(count(distinct run_type)) as num_unique, 
  coalesce(toInt64(countIf(run_type = 0)), 0) as num_empty, 
  toFloat64(coalesce(avg(run_type), 0)) as mean, 
  toFloat64(coalesce(min(run_type), 0)) as min, 
  toFloat64(coalesce(max(run_type), 0)) as max, 
  toFloat64(coalesce(median(run_type), 0)) as median, 
  toFloat64(coalesce(stddevSamp(run_type), 0)) as stddev
from default.runs 
where
  ingested_at >= parseDateTimeBestEffort('2025-01-01 00:00:00') and 
  ingested_at < parseDateTimeBestEffort('2025-02-01 00:00:00')
group by time_segment
order by time_segment 
---
